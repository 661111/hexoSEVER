style(type='text/css')
  | .pace {
  |   -webkit-pointer-events: none;
  |   pointer-events: none;
  |   -webkit-user-select: none;
  |   -moz-user-select: none;
  |   user-select: none;
  | }
  | .pace-inactive {
  |   display: none;
  | }
  | .pace .pace-progress {
  |   background: #29d;
  |   position: fixed;
  |   z-index: 2000;
  |   top: 0;
  |   right: 100%;
  |   width: 100%;
  |   height: 2px;
  | }
script(type='text/javascript')
  | // 注册 Service Worker 的函数
  | function registerServiceWorker() {
  |   if ('serviceWorker' in navigator) {
  |     window.addEventListener('load', () => {
  |       navigator.serviceWorker.register('/service-worker.js')
  |        .then((registration) => {
  |           console.log('ServiceWorker registration successful with scope: ', registration.scope);
  |         })
  |        .catch((err) => {
  |           console.error('ServiceWorker registration failed: ', err);
  |         });
  |     });
  |   }
  | }
  | 
  | // 向 Service Worker 发送消息并监听响应的函数
  | function sendMessageToServiceWorker() {
  |   if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
  |     try {
  |       // 发送更新指令到 Service Worker
  |       // 'update' 改为 'refresh' 即可触发缓存刷新
  |       navigator.serviceWorker.controller.postMessage('update');
  |       console.log('已向 Service Worker 发送 update 消息');
  | 
  |       // 监听 Service Worker 发送的消息
  |       navigator.serviceWorker.addEventListener('message', (event) => {
  |         const data = event.data;
  |         if (data && data.type) {
  |           switch (data.type) {
  |             case 'update':
  |               // 这里写更新后的操作
  |               console.log('收到 update 消息，执行更新后的操作');
  |               break;
  |             case 'refresh':
  |               // 这里写强刷缓存后的操作
  |               console.log('收到 refresh 消息，执行强刷缓存后的操作');
  |               break;
  |             default:
  |               console.error(`未知事件：${data.type}`);
  |           }
  |         } else {
  |           console.error('收到的消息缺少 type 属性', data);
  |         }
  |       });
  |     } catch (error) {
  |       console.error('向 Service Worker 发送消息时出错', error);
  |     }
  |   }
  | }
  | 
  | // 调用注册和发送消息的函数
  | registerServiceWorker();
  | sendMessageToServiceWorker();
script(type='text/javascript')
  | // 定义当 DOM 准备好时执行的函数
  | function whenDOMReady() {
  |   try {
  |     // 调用初始化文章相关的函数
  |     initEssay();
  |   } catch (error) {
  |     // 捕获并打印初始化过程中可能出现的错误
  |     console.error('初始化文章时出现错误:', error);
  |   }
  | }
  | 
  | // 页面加载完成时执行初始化函数
  | whenDOMReady();
  | 
  | // 监听 PJAX 加载完成事件，再次执行初始化函数
  | document.addEventListener("pjax:complete", whenDOMReady);
  | 
  | // 声明 Swiper 实例变量
  | let swiper;
  | 
  | // 检查页面中是否存在 #bber-talk 元素
  | if (document.querySelector('#bber-talk')) {
  |   // 初始化 Swiper 轮播组件
  |   swiper = new Swiper('.swiper-container', {
  |     // 设置轮播方向为垂直方向
  |     direction: 'vertical',
  |     // 开启循环播放
  |     loop: true,
  |     // 配置自动播放功能
  |     autoplay: {
  |       // 自动播放间隔时间为 3000 毫秒（即 3 秒）
  |       delay: 3000,
  |       // 鼠标悬停时暂停自动播放
  |       pauseOnMouseEnter: true
  |     }
  |   });
  | }
script(type='text/javascript')
  | /* switchDarkMode JS */
  | function switchDarkMode() { // Switch Between Light And Dark Mode
  |   const nowMode = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light';
  |   if (nowMode === 'light') {
  |     activateDarkMode();
  |     saveToLocal.set('theme', 'dark', 2);
  |     GLOBAL_CONFIG.Snackbar!== undefined && btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night);
  |   } else {
  |     activateLightMode();
  |     saveToLocal.set('theme', 'light', 2);
  |     GLOBAL_CONFIG.Snackbar!== undefined && btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day);
  |   }
  |   // handle some cases
  |   typeof utterancesTheme === 'function' && utterancesTheme();
  |   typeof FB === 'object' && window.loadFBComment();
  |   window.DISQUS && document.getElementById('disqus_thread').children.length && setTimeout(() => window.disqusReset(), 200);
  | }